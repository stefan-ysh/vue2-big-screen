{"ast":null,"code":"import { getDataJson, pollingRefresh } from '@/utils';\nexport default {\n  name: 'Dashboard',\n  props: {\n    cptId: String,\n    width: Number,\n    height: Number,\n    configProps: Object\n  },\n  data() {\n    return {\n      uuid: '',\n      chartOption: {},\n      chart: null,\n      cptData: {}\n    };\n  },\n  watch: {\n    'configProps.attribute': {\n      handler(newObj) {\n        this.loadChart(newObj);\n      },\n      deep: true // 深度监听\n    },\n\n    width() {\n      this.chart.resize();\n    },\n    height() {\n      this.chart.resize();\n    }\n  },\n  created() {\n    this.uuid = require('uuid').v1();\n  },\n  mounted() {\n    this.chart = this.$echarts.init(document.getElementById(this.uuid), 'dark');\n    this.refreshCptData();\n  },\n  methods: {\n    refreshCptData() {\n      pollingRefresh(this.uuid, this.configProps.cptDataForm, this.loadData);\n    },\n    loadData() {\n      getDataJson(this.configProps.cptDataForm, this.cptId).then(res => {\n        this.cptData = res;\n        this.loadChart(this.configProps.attribute);\n      });\n    },\n    loadChart(attribute) {\n      const that = this;\n      that.chartOption = {\n        backgroundColor: '',\n        tooltip: {\n          formatter: '{a} <br/>{b} : {c}%'\n        },\n        series: [{\n          name: 'Pressure',\n          type: 'gauge',\n          startAngle: attribute.startAngle,\n          endAngle: attribute.endAngle,\n          radius: '100%',\n          min: attribute.min,\n          max: attribute.max,\n          axisLabel: {\n            distance: attribute.labelDistance,\n            color: '#999',\n            fontSize: attribute.labelSize\n          },\n          axisTick: {\n            show: true,\n            length: attribute.tickLength,\n            distance: attribute.lineDistance\n          },\n          splitLine: {\n            distance: attribute.lineDistance,\n            length: attribute.tickLength * 1.5,\n            lineStyle: {\n              width: 2,\n              color: '#999'\n            }\n          },\n          axisLine: {\n            lineStyle: {\n              width: attribute.lineWidth,\n              color: [[0.3, attribute.color1], [0.7, attribute.color2], [1, attribute.color3]]\n            }\n          },\n          progress: {\n            show: true,\n            width: attribute.lineWidth\n          },\n          pointer: {\n            length: attribute.pointerLength + '%',\n            width: attribute.pointerWidth\n          },\n          itemStyle: {\n            color: attribute.itemColor\n          },\n          title: {\n            show: true,\n            fontSize: attribute.titleSize,\n            color: attribute.titleColor\n          },\n          detail: {\n            valueAnimation: true,\n            formatter: '{value}',\n            color: attribute.detailColor,\n            fontSize: attribute.detailSize\n          },\n          data: [{\n            value: that.cptData.value,\n            name: attribute.title\n          }]\n        }]\n      };\n      that.chart.setOption(that.chartOption);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}