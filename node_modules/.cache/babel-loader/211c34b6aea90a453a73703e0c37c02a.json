{"ast":null,"code":"import { getDataJson, pollingRefresh } from '@/utils';\nexport default {\n  name: 'TdColumnChart',\n  props: {\n    cptId: String,\n    width: Number,\n    height: Number,\n    configProps: Object\n  },\n  data() {\n    return {\n      uuid: null,\n      chartOption: {},\n      chart: undefined,\n      cptData: {}\n    };\n  },\n  watch: {\n    'configProps.attribute': {\n      handler(newObj) {\n        this.loadChart(newObj);\n      },\n      deep: true // 深度监听\n    },\n\n    width() {\n      this.chart.resize();\n    },\n    height() {\n      console.log('----', 11);\n      this.chart.resize();\n    }\n  },\n  created() {\n    this.uuid = require('uuid').v1();\n  },\n  mounted() {\n    this.chart = this.$echarts.init(document.getElementById(this.uuid));\n    this.refreshCptData();\n  },\n  methods: {\n    refreshCptData() {\n      pollingRefresh(this.uuid, this.configProps.cptDataForm, this.loadData);\n    },\n    loadData() {\n      getDataJson(this.configProps.cptDataForm, this.cptId).then(res => {\n        this.cptData = res;\n        this.loadChart(this.configProps.attribute);\n      });\n    },\n    loadChart(attribute) {\n      const that = this;\n      let columnColor = attribute.barColor;\n      if (attribute.gradualColor) {\n        columnColor = new this.$echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n          offset: 0,\n          color: attribute.barColor1\n        }, {\n          offset: 0.5,\n          color: attribute.barColor2\n        }, {\n          offset: 1,\n          color: attribute.barColor3\n        }]);\n      }\n      that.chartOption = {\n        color: columnColor,\n        title: {\n          text: attribute.chartTitle,\n          textStyle: {\n            color: attribute.titleTextColor\n          },\n          left: attribute.titleLeft,\n          top: attribute.titleTop\n        },\n        tooltip: {},\n        grid: {\n          x: 10,\n          y: 30,\n          x2: 10,\n          y2: 10,\n          containLabel: true\n        },\n        xAxis: {\n          show: attribute.xAxisShow,\n          type: 'category',\n          data: this.cptData.xData.split(','),\n          axisLabel: {\n            color: attribute.xLabelColor,\n            rotate: attribute.xFontRotate // 倾斜角度-180~180\n          },\n\n          axisLine: {\n            show: attribute.xLineShow,\n            lineStyle: {\n              color: attribute.xLineColor\n            }\n          },\n          axisTick: {\n            // x轴刻度线\n            show: attribute.xTickShow\n          }\n        },\n        yAxis: {\n          show: attribute.yAxisShow,\n          type: 'value',\n          axisLabel: {\n            color: attribute.yLabelColor\n          },\n          axisLine: {\n            show: attribute.yLineShow,\n            lineStyle: {\n              color: attribute.yLineColor\n            }\n          },\n          axisTick: {\n            // y轴刻度线\n            show: attribute.yTickShow\n          },\n          splitLine: {\n            // 网格线\n            show: attribute.yGridLineShow\n          }\n        },\n        series: [{\n          name: '新增用户数量',\n          type: 'bar',\n          // pictorialBar || bar\n          showBackground: attribute.barBgShow,\n          stack: 'account',\n          barWidth: attribute.barWidth,\n          data: this.cptData.yData.split(',')\n        }, {\n          name: '邀请新用户数量',\n          type: 'bar',\n          stack: 'account',\n          barWidth: attribute.barWidth,\n          itemStyle: {\n            color: new this.$echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: '#ffae88'\n            }, {\n              offset: 1,\n              color: '#ff7388'\n            }])\n          },\n          data: this.cptData.yData2.split(',')\n        }, {\n          z: 3,\n          type: 'pictorialBar',\n          symbolPosition: 'end',\n          symbol: 'diamond',\n          symbolOffset: [0, '-50%'],\n          symbolSize: [attribute.barWidth, 10],\n          symbolRotate: 0,\n          itemStyle: {\n            borderWidth: 0,\n            color: '#10e6ff'\n          },\n          data: this.cptData.yData3.split(',')\n        }, {\n          z: 3,\n          type: 'pictorialBar',\n          symbolPosition: 'end',\n          symbol: 'diamond',\n          symbolOffset: [0, '-50%'],\n          symbolSize: [attribute.barWidth, 10],\n          itemStyle: {\n            borderWidth: 0,\n            color: '#ffcf90'\n          },\n          data: this.cptData.yData4.split(',')\n        }]\n      };\n      that.chart.setOption(that.chartOption);\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}